<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Élections Municipales Bayonne – 1er Tour 2026</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;600;700;800;900&display=swap');
:root{
  --bg:#f0efeb;--surface:#fff;--border:#dddad2;
  --text:#1a1a2e;--text2:#555;--text3:#999;
  --pereira:#1a3a6e;--iriart:#2d7a3a;--etcheto:#c0436e;
  --etchegaray:#b03030;--lesellier:#5a2d14;
  --part:#e6a817;--abst:#c0392b;--blanc:#7f8c8d;--nul:#95a5a6;
  --gauche:#2d7a3a;--centre:#b03030;--rn:#5a2d14;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{width:100%;height:100%;overflow:hidden;font-family:'Source Sans 3','Segoe UI',sans-serif;background:var(--bg);color:var(--text)}
.slide{position:fixed;inset:0;display:none;flex-direction:column;width:100vw;height:100vh}
.slide.active{display:flex}
.header{display:flex;align-items:center;justify-content:space-between;background:#fff;border-bottom:3px solid var(--iriart);padding:0 2.5vw;flex-shrink:0;height:clamp(52px,8vh,76px)}
.htitle h1{font-size:clamp(13px,1.4vw,22px);font-weight:800;color:var(--text)}
.htitle p{font-size:clamp(10px,0.85vw,13px);color:var(--text2);margin-top:1px}
.hright{display:flex;align-items:center;gap:clamp(6px,.8vw,14px);flex-shrink:0}
.badge{background:var(--text);color:#fff;padding:clamp(5px,.9vh,10px) clamp(10px,1.3vw,20px);border-radius:8px;text-align:center;box-shadow:0 2px 8px rgba(0,0,0,0.28)}
.badge-lbl{font-size:clamp(7px,0.6vw,10px);font-weight:700;text-transform:uppercase;letter-spacing:0.7px;opacity:.7;display:block}
.badge-val{font-size:clamp(18px,2.1vw,34px);font-weight:800;line-height:1.1;display:block}
.badge-sub{font-size:clamp(7px,0.55vw,9px);opacity:.6;display:block}
/* Bouton refresh manuel */
.rbtn{background:none;border:1px solid var(--border);border-radius:7px;padding:clamp(4px,.6vh,8px) clamp(8px,.9vw,14px);cursor:pointer;font-size:clamp(10px,.85vw,14px);color:var(--text2);font-family:inherit;font-weight:600;display:flex;align-items:center;gap:5px;transition:all .15s;white-space:nowrap}
.rbtn:hover{background:var(--iriart);color:#fff;border-color:var(--iriart)}
.rbtn.spin svg{animation:spin .7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
/* SLIDE 1 */
#s1 .sbody{display:flex;flex-direction:column;flex:1;padding:clamp(6px,1.2vh,16px) clamp(14px,2.5vw,44px) clamp(30px,5vh,50px);gap:clamp(5px,.8vh,12px);overflow:hidden;min-height:0}
.chart{flex:1;display:flex;flex-direction:column;min-height:0;overflow:hidden}
.brow{display:flex;align-items:center;flex:1;min-height:0;max-height:clamp(36px,7vh,72px)}
.blbl{width:clamp(140px,20vw,300px);flex-shrink:0;padding-right:clamp(6px,1vw,16px);text-align:right}
.blbl .ln{font-size:clamp(12px,1.3vw,21px);font-weight:800;display:block;line-height:1.1}
.blbl .cn{font-size:clamp(9px,0.82vw,13px);color:var(--text2);display:block;line-height:1.1}
.btrk{flex:1;position:relative;height:clamp(18px,3.5vh,42px);display:flex;align-items:center}
.bline{position:absolute;left:0;top:0;width:2px;height:100%;background:#ccc;z-index:2}
.bfill{height:78%;border-radius:0 5px 5px 0;transition:width .9s cubic-bezier(.4,0,.2,1);min-width:3px;display:flex;align-items:center;padding-left:.7vw;position:relative;z-index:1}
.bpct{font-size:clamp(12px,1.4vw,22px);font-weight:900;color:#fff;text-shadow:0 1px 3px rgba(0,0,0,.45);white-space:nowrap}
.bpct-o{font-size:clamp(12px,1.4vw,22px);font-weight:900;color:var(--text);margin-left:.7vw;white-space:nowrap}
.scards{display:grid;grid-template-columns:repeat(4,1fr);gap:clamp(5px,.7vw,12px);flex-shrink:0;height:clamp(68px,11.5vh,104px)}
.sc{background:var(--surface);border:1px solid var(--border);border-radius:8px;border-top:4px solid var(--border);padding:clamp(4px,.6vh,9px) clamp(7px,.9vw,14px);display:flex;flex-direction:column;justify-content:center;gap:.1vh;overflow:hidden;min-width:0}
.sc.p{border-top-color:var(--part)}.sc.a{border-top-color:var(--abst)}.sc.b{border-top-color:var(--blanc)}.sc.n{border-top-color:var(--nul)}
.slbl{font-size:clamp(8px,.68vw,11px);font-weight:700;text-transform:uppercase;letter-spacing:.8px;color:var(--text2);white-space:nowrap}
.sval{font-size:clamp(17px,2.3vw,38px);font-weight:900;line-height:1}
.sc.p .sval{color:var(--part)}.sc.a .sval{color:var(--abst)}
.ssub{font-size:clamp(8px,.6vw,10px);color:var(--text3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
/* CARTES */
.map-slide .sbody{display:flex;flex-direction:column;flex:1;padding:clamp(5px,.9vh,12px) clamp(8px,1.3vw,18px) clamp(30px,5vh,50px);gap:clamp(5px,.8vh,10px);overflow:hidden;min-height:0}
.map-wrap{flex:1;position:relative;overflow:hidden;min-height:0;background:var(--surface);border:1px solid var(--border);border-radius:10px}
.map-svg{width:100%;height:100%;display:block}
.map-overlay-title{position:absolute;top:clamp(8px,1.2vh,18px);left:clamp(10px,1.5vw,22px);background:rgba(255,255,255,0.95);border-radius:7px;padding:clamp(5px,.7vh,10px) clamp(10px,1.2vw,18px);box-shadow:0 2px 12px rgba(0,0,0,0.15);z-index:10;pointer-events:none}
.map-overlay-title .mot-name{font-size:clamp(15px,1.7vw,28px);font-weight:900;display:block;line-height:1.1}
.map-overlay-title .mot-sub{font-size:clamp(10px,.82vw,13px);color:var(--text2);display:block;margin-top:2px}
.mtt{position:absolute;background:rgba(26,26,46,.93);color:#fff;padding:7px 12px;border-radius:6px;font-size:clamp(11px,.9vw,15px);pointer-events:none;display:none;z-index:100;white-space:nowrap;line-height:1.7}
.map-stats{display:flex;align-items:center;justify-content:center;gap:clamp(10px,1.6vw,28px);flex-shrink:0;height:clamp(66px,11vh,100px)}
.mstat{background:var(--surface);border:1px solid var(--border);border-radius:9px;padding:clamp(5px,.8vh,10px) clamp(12px,1.7vw,26px);display:flex;flex-direction:column;align-items:center;justify-content:center;min-width:clamp(110px,13vw,185px)}
.mstat-lbl{font-size:clamp(9px,.72vw,12px);font-weight:700;text-transform:uppercase;letter-spacing:.7px;color:var(--text2)}
.mstat-val{font-size:clamp(24px,3.4vw,54px);font-weight:900;line-height:1}
.mstat-sub{font-size:clamp(8px,.62vw,11px);color:var(--text3)}
.mleg{display:flex;align-items:center;gap:.7vw;font-size:clamp(10px,.78vw,13px);font-weight:600;color:var(--text2)}
.lgrad{width:clamp(50px,6.5vw,110px);height:10px;border-radius:5px;border:1px solid #ccc}
/* SLIDE 8 */
#s8 .sbody{display:flex;flex:1;padding:clamp(5px,.9vh,12px) clamp(8px,1.3vw,18px) clamp(30px,5vh,50px);gap:clamp(8px,1.1vw,16px);overflow:hidden;min-height:0}
.classement{flex:0 0 clamp(240px,32vw,450px);display:flex;flex-direction:column;gap:clamp(3px,.5vh,7px);overflow:hidden;min-height:0}
.sec-title{font-size:clamp(10px,.8vw,13px);font-weight:700;text-transform:uppercase;letter-spacing:.7px;color:var(--text2);flex-shrink:0;padding-bottom:clamp(2px,.3vh,5px);border-bottom:1px solid var(--border);margin-bottom:clamp(2px,.3vh,4px)}
.cls-rows{flex:1;display:flex;flex-direction:column;justify-content:space-between;min-height:0;gap:clamp(3px,.4vh,6px)}
.cls-row{display:flex;align-items:center;gap:clamp(5px,.7vw,12px);background:var(--surface);border:1px solid var(--border);border-radius:9px;padding:clamp(4px,.65vh,9px) clamp(7px,.9vw,14px);flex:1;min-height:0;overflow:hidden}
.cls-rank{font-size:clamp(17px,2.2vw,34px);font-weight:900;color:#ddd;width:clamp(24px,2.4vw,36px);text-align:center;flex-shrink:0}
.cls-dot{width:clamp(8px,.85vw,13px);height:clamp(8px,.85vw,13px);border-radius:50%;flex-shrink:0}
.cls-info{flex:1;min-width:0}
.cls-nom{font-size:clamp(11px,1.2vw,19px);font-weight:800;display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.cls-detail{font-size:clamp(8px,.78vw,12px);color:var(--text2);display:block}
.cls-right{text-align:right;flex-shrink:0}
.cls-pct{font-size:clamp(17px,2vw,30px);font-weight:900;display:block;line-height:1}
.cls-voix{font-size:clamp(8px,.68vw,11px);color:var(--text3)}
.cls-badge{font-size:clamp(7px,.62vw,10px);font-weight:700;padding:1px 7px;border-radius:20px;white-space:nowrap;margin-top:1px;display:inline-block}
.cls-badge.ok{background:#d4edda;color:#155724}.cls-badge.no{background:#f8d7da;color:#721c24}.cls-badge.prov{background:#fff3cd;color:#856404}
/* Histogramme blocs */
.blocs-chart{flex:1;display:flex;flex-direction:column;gap:clamp(3px,.5vh,7px);overflow:hidden;min-height:0}
.bloc-hist-wrap{flex:1;display:flex;align-items:flex-end;justify-content:space-around;padding:clamp(30px,5vh,55px) clamp(12px,2.5vw,36px) 0;min-height:0;position:relative}
.bloc-hist-wrap::after{content:'';position:absolute;bottom:0;left:0;right:0;height:2px;background:var(--border)}
.bhcol{display:flex;flex-direction:column;align-items:center;gap:clamp(5px,.7vh,10px);position:relative;flex:1;max-width:clamp(80px,14vw,180px)}
.bhcol-bars{width:100%;position:relative;overflow:visible;flex:0 0 auto;min-height:4px}
.bh-pct-top{position:absolute;top:-clamp(24px,3.8vh,42px);left:0;right:0;text-align:center;font-size:clamp(15px,1.9vw,30px);font-weight:900;white-space:nowrap;line-height:1}
.bh-seg{width:100%;transition:height .9s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;display:block}
.bh-seg:first-child{border-radius:6px 6px 0 0}
.bh-seg-lbl{position:absolute;bottom:clamp(2px,.3vh,4px);left:0;right:0;text-align:center;font-size:clamp(8px,.7vw,12px);color:rgba(255,255,255,.9);font-weight:700;pointer-events:none;line-height:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:0 2px}
.bh-legend{text-align:center;flex-shrink:0}
.bh-leg-name{font-size:clamp(12px,1.2vw,19px);font-weight:800;display:block}
.bh-leg-sub{font-size:clamp(8px,.7vw,11px);color:var(--text2);display:block;margin-top:1px}
.bh-leg-voix{font-size:clamp(8px,.68vw,11px);color:var(--text3);display:block}
/* CONTROLS */
.ctrl{position:fixed;bottom:clamp(5px,1vh,11px);left:50%;transform:translateX(-50%);display:flex;align-items:center;gap:clamp(4px,.6vw,9px);background:rgba(255,255,255,.96);border:1px solid var(--border);border-radius:40px;padding:clamp(4px,.5vh,7px) clamp(9px,1.2vw,16px);box-shadow:0 2px 14px rgba(0,0,0,.13);z-index:500;white-space:nowrap}
.cbtn{background:none;border:1px solid var(--border);border-radius:50%;width:clamp(26px,2.4vw,38px);height:clamp(26px,2.4vw,38px);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:clamp(11px,1vw,16px);color:var(--text);transition:all .15s;flex-shrink:0}
.cbtn:hover{background:#f0f0f0}.cbtn.paused{background:var(--iriart);color:#fff;border-color:var(--iriart)}
.dwrap{display:flex;gap:clamp(3px,.35vw,5px);align-items:center}
.cdot{width:clamp(6px,.6vw,9px);height:clamp(6px,.6vw,9px);border-radius:50%;background:#ddd;cursor:pointer;transition:background .2s;flex-shrink:0;border:2px solid transparent}
.cdot.active{background:var(--iriart);border-color:var(--iriart)}
.slide-lbl{font-size:clamp(8px,.62vw,11px);color:var(--text2);min-width:clamp(60px,7.5vw,115px);text-align:center;font-weight:600}
.rtxt{font-size:clamp(7px,.55vw,10px);color:var(--text3)}
</style>
</head>
<body>
<div id="s1" class="slide active">
  <div class="header">
    <div class="htitle"><h1>Élections Municipales à Bayonne — 1er Tour</h1><p>15 mars 2026 · Résultats en direct</p></div>
    <div class="hright">
      <button class="rbtn" id="rbtns1" title="Forcer la mise à jour"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>Actualiser</button>
      <div class="badge">
        <span class="badge-lbl">Résultats obtenus</span>
        <span class="badge-val" id="s1bv">0 / 30</span>
        <span class="badge-sub" id="s1bvps"></span>
      </div>
    </div>
  </div>
  <div class="sbody">
    <div class="chart" id="chart"></div>
    <div class="scards">
      <div class="sc p"><div class="slbl">Participation</div><div class="sval" id="vpart">–</div><div class="ssub" id="sp-sub"></div></div>
      <div class="sc a"><div class="slbl">Abstention</div><div class="sval" id="vabst">–</div><div class="ssub" id="sa-sub"></div></div>
      <div class="sc b"><div class="slbl">Blancs</div><div class="sval" id="vblanc">–</div><div class="ssub" id="sb-sub"></div></div>
      <div class="sc n"><div class="slbl">Nuls</div><div class="sval" id="vnul">–</div><div class="ssub" id="sn-sub"></div></div>
    </div>
  </div>
</div>

<div id="s2" class="slide map-slide">
  <div class="header">
    <div class="htitle"><h1>Élections Municipales à Bayonne — 1er Tour</h1><p>15 mars 2026 · Résultats en direct</p></div>
    <div class="hright">
      <button class="rbtn" id="rbtns2" title="Forcer la mise à jour"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>Actualiser</button>
      <div class="badge">
        <span class="badge-lbl">Résultats obtenus</span>
        <span class="badge-val" id="s2bv">0 / 30</span>
        <span class="badge-sub" id="s2bvps"></span>
      </div>
    </div>
  </div>
  <div class="sbody">
    <div class="map-wrap" id="mws2">
      <svg class="map-svg" id="msvs2" preserveAspectRatio="xMidYMid meet">
        <g id="mps2"></g><g id="mls2"></g>
      </svg>
      <div class="map-overlay-title">
        <span class="mot-name">Participation par bureau de vote</span>
        <span class="mot-sub">15 mars 2026 &middot; résultats en direct</span>
      </div>
      <div class="mtt" id="mtts2"></div>
    </div>
    <div class="map-stats">
    <div class="mstat">
      <div class="mstat-lbl">Participation</div>
      <div class="mstat-val" id="s2part" style="color:var(--part)">–</div>
      <div class="mstat-sub" id="s2part-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Abstention</div>
      <div class="mstat-val" id="s2abst" style="color:var(--abst)">–</div>
      <div class="mstat-sub" id="s2abst-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Inscrits</div>
      <div class="mstat-val" id="s2ins" style="color:var(--text)">–</div>
      <div class="mstat-sub" id="s2ins-sub"></div>
    </div>
      <div style="display:flex;flex-direction:column;align-items:center;gap:3px">
        <div class="mleg"><span id="lg0s2">0 %</span><div class="lgrad" id="lgs2"></div><span id="lgmaxs2">–</span></div>
        <div style="font-size:clamp(8px,.62vw,11px);color:#bbb">&#9632; gris = non obtenu</div>
      </div>
    </div>
  </div>
</div>
<div id="s3" class="slide map-slide">
  <div class="header">
    <div class="htitle"><h1>Élections Municipales à Bayonne — 1er Tour</h1><p>15 mars 2026 · Résultats en direct</p></div>
    <div class="hright">
      <button class="rbtn" id="rbtns3" title="Forcer la mise à jour"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>Actualiser</button>
      <div class="badge">
        <span class="badge-lbl">Résultats obtenus</span>
        <span class="badge-val" id="s3bv">0 / 30</span>
        <span class="badge-sub" id="s3bvps"></span>
      </div>
    </div>
  </div>
  <div class="sbody">
    <div class="map-wrap" id="mws3">
      <svg class="map-svg" id="msvs3" preserveAspectRatio="xMidYMid meet">
        <g id="mps3"></g><g id="mls3"></g>
      </svg>
      <div class="map-overlay-title">
        <span class="mot-name" style="color:#1a3a6e">Liste Pereira (LFI)</span>
        <span class="mot-sub">15 mars 2026 &middot; résultats en direct</span>
      </div>
      <div class="mtt" id="mtts3"></div>
    </div>
    <div class="map-stats">
    <div class="mstat">
      <div class="mstat-lbl">Score global</div>
      <div class="mstat-val" id="s3pct" style="color:#1a3a6e">–</div>
      <div class="mstat-sub" id="s3pct-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Voix totales</div>
      <div class="mstat-val" id="s3vx" style="color:var(--text)">–</div>
      <div class="mstat-sub" id="s3vx-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Meilleur BV</div>
      <div class="mstat-val" id="s3bv1" style="color:#1a3a6e">–</div>
      <div class="mstat-sub" id="s3bv1-sub"></div>
    </div>
      <div style="display:flex;flex-direction:column;align-items:center;gap:3px">
        <div class="mleg"><span id="lg0s3">0 %</span><div class="lgrad" id="lgs3"></div><span id="lgmaxs3">–</span></div>
        <div style="font-size:clamp(8px,.62vw,11px);color:#bbb">&#9632; gris = non obtenu</div>
      </div>
    </div>
  </div>
</div>
<div id="s4" class="slide map-slide">
  <div class="header">
    <div class="htitle"><h1>Élections Municipales à Bayonne — 1er Tour</h1><p>15 mars 2026 · Résultats en direct</p></div>
    <div class="hright">
      <button class="rbtn" id="rbtns4" title="Forcer la mise à jour"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>Actualiser</button>
      <div class="badge">
        <span class="badge-lbl">Résultats obtenus</span>
        <span class="badge-val" id="s4bv">0 / 30</span>
        <span class="badge-sub" id="s4bvps"></span>
      </div>
    </div>
  </div>
  <div class="sbody">
    <div class="map-wrap" id="mws4">
      <svg class="map-svg" id="msvs4" preserveAspectRatio="xMidYMid meet">
        <g id="mps4"></g><g id="mls4"></g>
      </svg>
      <div class="map-overlay-title">
        <span class="mot-name" style="color:#2d7a3a">Bayonne en Mouvement – Iriart</span>
        <span class="mot-sub">15 mars 2026 &middot; résultats en direct</span>
      </div>
      <div class="mtt" id="mtts4"></div>
    </div>
    <div class="map-stats">
    <div class="mstat">
      <div class="mstat-lbl">Score global</div>
      <div class="mstat-val" id="s4pct" style="color:#2d7a3a">–</div>
      <div class="mstat-sub" id="s4pct-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Voix totales</div>
      <div class="mstat-val" id="s4vx" style="color:var(--text)">–</div>
      <div class="mstat-sub" id="s4vx-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Meilleur BV</div>
      <div class="mstat-val" id="s4bv1" style="color:#2d7a3a">–</div>
      <div class="mstat-sub" id="s4bv1-sub"></div>
    </div>
      <div style="display:flex;flex-direction:column;align-items:center;gap:3px">
        <div class="mleg"><span id="lg0s4">0 %</span><div class="lgrad" id="lgs4"></div><span id="lgmaxs4">–</span></div>
        <div style="font-size:clamp(8px,.62vw,11px);color:#bbb">&#9632; gris = non obtenu</div>
      </div>
    </div>
  </div>
</div>
<div id="s5" class="slide map-slide">
  <div class="header">
    <div class="htitle"><h1>Élections Municipales à Bayonne — 1er Tour</h1><p>15 mars 2026 · Résultats en direct</p></div>
    <div class="hright">
      <button class="rbtn" id="rbtns5" title="Forcer la mise à jour"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>Actualiser</button>
      <div class="badge">
        <span class="badge-lbl">Résultats obtenus</span>
        <span class="badge-val" id="s5bv">0 / 30</span>
        <span class="badge-sub" id="s5bvps"></span>
      </div>
    </div>
  </div>
  <div class="sbody">
    <div class="map-wrap" id="mws5">
      <svg class="map-svg" id="msvs5" preserveAspectRatio="xMidYMid meet">
        <g id="mps5"></g><g id="mls5"></g>
      </svg>
      <div class="map-overlay-title">
        <span class="mot-name" style="color:#c0436e">Liste Etcheto</span>
        <span class="mot-sub">15 mars 2026 &middot; résultats en direct</span>
      </div>
      <div class="mtt" id="mtts5"></div>
    </div>
    <div class="map-stats">
    <div class="mstat">
      <div class="mstat-lbl">Score global</div>
      <div class="mstat-val" id="s5pct" style="color:#c0436e">–</div>
      <div class="mstat-sub" id="s5pct-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Voix totales</div>
      <div class="mstat-val" id="s5vx" style="color:var(--text)">–</div>
      <div class="mstat-sub" id="s5vx-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Meilleur BV</div>
      <div class="mstat-val" id="s5bv1" style="color:#c0436e">–</div>
      <div class="mstat-sub" id="s5bv1-sub"></div>
    </div>
      <div style="display:flex;flex-direction:column;align-items:center;gap:3px">
        <div class="mleg"><span id="lg0s5">0 %</span><div class="lgrad" id="lgs5"></div><span id="lgmaxs5">–</span></div>
        <div style="font-size:clamp(8px,.62vw,11px);color:#bbb">&#9632; gris = non obtenu</div>
      </div>
    </div>
  </div>
</div>
<div id="s6" class="slide map-slide">
  <div class="header">
    <div class="htitle"><h1>Élections Municipales à Bayonne — 1er Tour</h1><p>15 mars 2026 · Résultats en direct</p></div>
    <div class="hright">
      <button class="rbtn" id="rbtns6" title="Forcer la mise à jour"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>Actualiser</button>
      <div class="badge">
        <span class="badge-lbl">Résultats obtenus</span>
        <span class="badge-val" id="s6bv">0 / 30</span>
        <span class="badge-sub" id="s6bvps"></span>
      </div>
    </div>
  </div>
  <div class="sbody">
    <div class="map-wrap" id="mws6">
      <svg class="map-svg" id="msvs6" preserveAspectRatio="xMidYMid meet">
        <g id="mps6"></g><g id="mls6"></g>
      </svg>
      <div class="map-overlay-title">
        <span class="mot-name" style="color:#b03030">Liste Etchegaray – Centre et Droite</span>
        <span class="mot-sub">15 mars 2026 &middot; résultats en direct</span>
      </div>
      <div class="mtt" id="mtts6"></div>
    </div>
    <div class="map-stats">
    <div class="mstat">
      <div class="mstat-lbl">Score global</div>
      <div class="mstat-val" id="s6pct" style="color:#b03030">–</div>
      <div class="mstat-sub" id="s6pct-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Voix totales</div>
      <div class="mstat-val" id="s6vx" style="color:var(--text)">–</div>
      <div class="mstat-sub" id="s6vx-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Meilleur BV</div>
      <div class="mstat-val" id="s6bv1" style="color:#b03030">–</div>
      <div class="mstat-sub" id="s6bv1-sub"></div>
    </div>
      <div style="display:flex;flex-direction:column;align-items:center;gap:3px">
        <div class="mleg"><span id="lg0s6">0 %</span><div class="lgrad" id="lgs6"></div><span id="lgmaxs6">–</span></div>
        <div style="font-size:clamp(8px,.62vw,11px);color:#bbb">&#9632; gris = non obtenu</div>
      </div>
    </div>
  </div>
</div>
<div id="s7" class="slide map-slide">
  <div class="header">
    <div class="htitle"><h1>Élections Municipales à Bayonne — 1er Tour</h1><p>15 mars 2026 · Résultats en direct</p></div>
    <div class="hright">
      <button class="rbtn" id="rbtns7" title="Forcer la mise à jour"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>Actualiser</button>
      <div class="badge">
        <span class="badge-lbl">Résultats obtenus</span>
        <span class="badge-val" id="s7bv">0 / 30</span>
        <span class="badge-sub" id="s7bvps"></span>
      </div>
    </div>
  </div>
  <div class="sbody">
    <div class="map-wrap" id="mws7">
      <svg class="map-svg" id="msvs7" preserveAspectRatio="xMidYMid meet">
        <g id="mps7"></g><g id="mls7"></g>
      </svg>
      <div class="map-overlay-title">
        <span class="mot-name" style="color:#5a2d14">Liste Lesellier – Rassemblement National</span>
        <span class="mot-sub">15 mars 2026 &middot; résultats en direct</span>
      </div>
      <div class="mtt" id="mtts7"></div>
    </div>
    <div class="map-stats">
    <div class="mstat">
      <div class="mstat-lbl">Score global</div>
      <div class="mstat-val" id="s7pct" style="color:#5a2d14">–</div>
      <div class="mstat-sub" id="s7pct-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Voix totales</div>
      <div class="mstat-val" id="s7vx" style="color:var(--text)">–</div>
      <div class="mstat-sub" id="s7vx-sub"></div>
    </div>
    <div class="mstat">
      <div class="mstat-lbl">Meilleur BV</div>
      <div class="mstat-val" id="s7bv1" style="color:#5a2d14">–</div>
      <div class="mstat-sub" id="s7bv1-sub"></div>
    </div>
      <div style="display:flex;flex-direction:column;align-items:center;gap:3px">
        <div class="mleg"><span id="lg0s7">0 %</span><div class="lgrad" id="lgs7"></div><span id="lgmaxs7">–</span></div>
        <div style="font-size:clamp(8px,.62vw,11px);color:#bbb">&#9632; gris = non obtenu</div>
      </div>
    </div>
  </div>
</div>
<div id="s8" class="slide">
  <div class="header">
    <div class="htitle"><h1>Élections Municipales à Bayonne — Synthèse</h1><p>15 mars 2026 · Classement et blocs politiques</p></div>
    <div class="hright">
      <button class="rbtn" id="rbtns8" title="Forcer la mise à jour"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>Actualiser</button>
      <div class="badge">
        <span class="badge-lbl">Résultats obtenus</span>
        <span class="badge-val" id="s8bv">0 / 30</span>
        <span class="badge-sub" id="s8bvps"></span>
      </div>
    </div>
  </div>
  <div class="sbody">
    <div class="classement">
      <div class="sec-title">Classement — suffrages exprimés</div>
      <div class="cls-rows" id="cls-rows"></div>
    </div>
    <div class="blocs-chart">
      <div class="sec-title">Blocs politiques — suffrages exprimés</div>
      <div class="bloc-hist-wrap" id="bloc-hist"></div>
    </div>
  </div>
</div>
<div class="ctrl">
  <button class="cbtn" id="bprev" title="Précédent (←)">&#9664;</button>
  <div class="dwrap">
    <div class="cdot active" id="d1" onclick="goSlide(1)"></div>
    <div class="cdot" id="d2" onclick="goSlide(2)"></div>
    <div class="cdot" id="d3" onclick="goSlide(3)"></div>
    <div class="cdot" id="d4" onclick="goSlide(4)"></div>
    <div class="cdot" id="d5" onclick="goSlide(5)"></div>
    <div class="cdot" id="d6" onclick="goSlide(6)"></div>
    <div class="cdot" id="d7" onclick="goSlide(7)"></div>
    <div class="cdot" id="d8" onclick="goSlide(8)"></div>
  </div>
  <span class="slide-lbl" id="slide-lbl">Résultats globaux</span>
  <button class="cbtn" id="bpause" title="Pause (Espace)">&#9646;&#9646;</button>
  <button class="cbtn" id="bnext" title="Suivant (→)">&#9654;</button>
  <span class="rtxt">&#8635; <span id="cdown">60</span>s</span>
</div>
<script>
const GEOJSON={"type":"FeatureCollection","features":[{"type":"Feature","properties":{"bv":1},"geometry":{"type":"Polygon","coordinates":[[[-1.4778456056371252,43.49222905780133],[-1.4797297757393524,43.49185818661697],[-1.479733988882118,43.49285038173898],[-1.4778977944761382,43.49510691089609],[-1.4778307852277959,43.49797044635936],[-1.476113336676239,43.49863841764782],[-1.4751130940712567,43.49526126591005],[-1.4735220130557245,43.49419311627171],[-1.4741359284914246,43.492372000379845],[-1.4757496956684084,43.49099190225914],[-1.4778456056371252,43.49222905780133]]]}},{"type":"Feature","properties":{"bv":10},"geometry":{"type":"MultiPolygon","coordinates":[[[[-1.492158999999998,43.453320999999974],[-1.493535999999999,43.44986999999998],[-1.4951399999999995,43.45080900000001],[-1.4953039999999975,43.45259599999999],[-1.4938489999999995,43.457230999999986],[-1.494867999999998,43.457074],[-1.496124999999998,43.45980499999999],[-1.4963639999999991,43.462845999999985],[-1.4985219999999977,43.46406],[-1.4970469999999987,43.46450499999999],[-1.497203999999999,43.46585499999999],[-1.496070999999999,43.46852599999998],[-1.4928589999999988,43.470071],[-1.4921369999999994,43.47156799999998],[-1.489996999999999,43.472275],[-1.4906699999999993,43.47567999999997],[-1.4914933204750416,43.47677040003571],[-1.4889884581993562,43.47799761443924],[-1.4892167979110644,43.47853266269392],[-1.4872740276616314,43.477621014558764],[-1.4871999762958124,43.47629377791462],[-1.4858679379076245,43.47585028554507],[-1.4845868015682961,43.47624101975337],[-1.4840839218931896,43.474361967484654],[-1.4832948855728998,43.47547174103533],[-1.4834976230692785,43.474321516055916],[-1.4825297604881231,43.47427207466277],[-1.4825006326854582,43.47133356311788],[-1.4799713027449857,43.46893384302567],[-1.4721504341046454,43.46690072310815],[-1.4775639999999974,43.46712999999996],[-1.4784719999999991,43.46581299999999],[-1.4803829999999991,43.46582399999999],[-1.4818639999999994,43.46440799999998],[-1.4805729999999981,43.462595],[-1.4810749999999984,43.460704],[-1.482765999999999,43.45916699999998],[-1.4859789999999977,43.457851000000005],[-1.4845389999999996,43.456294],[-1.4847569999999988,43.455159999999985],[-1.4854209999999994,43.455018],[-1.4861429999999982,43.455818999999984],[-1.4868619999999992,43.45503299999998],[-1.4891669999999986,43.45514599999997],[-1.492158999999998,43.453320999999974]]]]}},{"type":"Feature","properties":{"bv":11},"geometry":{"type":"Polygon","coordinates":[[[-1.4860385015564164,43.47625857367055],[-1.4871999762958124,43.47629377791462],[-1.4872740276616314,43.477621014558764],[-1.4886262487562163,43.47826981478968],[-1.4879304839726717,43.479616763005765],[-1.4873714321070335,43.47853154467837],[-1.4861326233901113,43.478910598047364],[-1.4852927316154323,43.47777522714663],[-1.4830217351824482,43.47845497203706],[-1.4832257547719396,43.479230825602436],[-1.4810717337117478,43.482116090783904],[-1.4774513325094867,43.48137855538195],[-1.4758976995831306,43.48209253253849],[-1.4756853833361652,43.480235192809985],[-1.4733390600650567,43.47998950896286],[-1.4745861536695848,43.47577268272814],[-1.4703030743367786,43.46684169339359],[-1.4799713027449857,43.46893384302567],[-1.4825006326854582,43.47133356311788],[-1.4825297604881231,43.47427207466277],[-1.4834976230692785,43.474321516055916],[-1.4832948855728998,43.47547174103533],[-1.4840839218931896,43.474361967484654],[-1.4845868015682961,43.47624101975337],[-1.4858679379076245,43.47585028554507],[-1.4860385015564164,43.47625857367055]]]}},{"type":"Feature","properties":{"bv":12},"geometry":{"type":"Polygon","coordinates":[[[-1.4968369999999975,43.477124999999994],[-1.504579999999999,43.477944999999984],[-1.5047914860445208,43.47866760704463],[-1.503473109599078,43.479694664407],[-1.5032804203748173,43.478677680483734],[-1.5026096084745761,43.47962844043582],[-1.4988460722578252,43.47944276845624],[-1.4982815571509729,43.478683819278],[-1.497423859027848,43.479632524408046],[-1.4967088983564913,43.478154869790636],[-1.4961393192216756,43.4791214189774],[-1.4956052959262855,43.47836968079159],[-1.4918506548285841,43.47812385273583],[-1.4915629080325286,43.477559972243114],[-1.4914798026460612,43.476514260483164],[-1.4923609999999992,43.47731499999999],[-1.493689999999999,43.477130999999986],[-1.4955559999999992,43.475552999999984],[-1.4972679999999985,43.47599399999998],[-1.4968369999999975,43.477124999999994]]]}},{"type":"Feature","properties":{"bv":13},"geometry":{"type":"MultiPolygon","coordinates":[[[[-1.4992521802325613,43.47915583139533],[-1.5014896886663591,43.47955877065334],[-1.5009756061946906,43.48049755309733],[-1.496198880730262,43.482486119950906],[-1.4952723358086164,43.483892943845476],[-1.4954576152457235,43.4829920039921],[-1.4947932930610544,43.482155293250145],[-1.4916775366252863,43.4803210441093],[-1.4918506548285841,43.47812385273583],[-1.4956052959262855,43.47836968079159],[-1.4961393192216756,43.4791214189774],[-1.4967088983564913,43.478154869790636],[-1.497423859027848,43.479632524408046],[-1.4982815571509729,43.478683819278],[-1.4988460722578252,43.47944276845624],[-1.4992521802325613,43.47915583139533]]],[[[-1.466697139859521,43.49309476482617],[-1.4662241945604901,43.492573972521036],[-1.466962059613767,43.49139563900458],[-1.4673802957145383,43.491550753616224],[-1.466697139859521,43.49309476482617]]]]}},{"type":"Feature","properties":{"bv":14},"geometry":{"type":"MultiPolygon","coordinates":[[[[-1.5045387025200585,43.4786790302068],[-1.5048499999999987,43.481285999999976],[-1.5012629999999993,43.484351999999994],[-1.499674999999998,43.484413999999994],[-1.4952446166808961,43.493359021049535],[-1.4926856721488204,43.491742889632135],[-1.4911900603553911,43.48903479788354],[-1.4898222468869307,43.48355622153087],[-1.4916775366252863,43.4803210441093],[-1.4947932930610544,43.482155293250145],[-1.4954576152457235,43.4829920039921],[-1.4952723358086164,43.483892943845476],[-1.4963675235913916,43.48238885616123],[-1.499788415825759,43.4811430780786],[-1.5032804203748173,43.478677680483734],[-1.503360763538058,43.47968658642696],[-1.504406572648584,43.47932361047608],[-1.5045387025200585,43.4786790302068]]]]}},{"type":"Feature","properties":{"bv":15},"geometry":{"type":"Polygon","coordinates":[[[-1.4646810304814255,43.48117981371718],[-1.4654868371544227,43.481336346426154],[-1.466349777186232,43.483355678463255],[-1.464741197154749,43.48526300082266],[-1.4668614225016992,43.487379092794015],[-1.4660801436525606,43.48818692538975],[-1.465271845089921,43.4880030091329],[-1.464478364862934,43.48951766203621],[-1.459381330080273,43.48802270295531],[-1.4552279053443096,43.4846234220537],[-1.4533252166906194,43.48442434300968],[-1.4482964391162236,43.48641314612731],[-1.4455115676131383,43.48336741418536],[-1.4463909999999984,43.48294299999997],[-1.4450029999999991,43.48252699999998],[-1.4448219999999992,43.48143199999999],[-1.4458259999999987,43.481282],[-1.4450949999999987,43.48004999999999],[-1.445826999999998,43.47921899999998],[-1.4451889999999983,43.47881799999999],[-1.4501629999999992,43.47551999999999],[-1.4539459999999984,43.474779],[-1.4542719999999993,43.476107999999996],[-1.4563409999999988,43.47837199999998],[-1.4579089999999983,43.47785399999999],[-1.4589769999999982,43.47914899999999],[-1.4584809999999986,43.479527],[-1.4601494706957894,43.480372722809776],[-1.4601316994849007,43.48239450439655],[-1.4632814344071423,43.482162791090715],[-1.4643017604392001,43.480430799957055],[-1.4646810304814255,43.48117981371718]]]}},{"type":"Feature","properties":{"bv":16},"geometry":{"type":"MultiPolygon","coordinates":[[[[-1.4701822584737938,43.46683554034897],[-1.4701681001874902,43.46853389114678],[-1.4689149999999982,43.46677099999998],[-1.4701822584737938,43.46683554034897]]],[[[-1.4745274139065903,43.48798587384075],[-1.4746545453427171,43.489840208712465],[-1.472000163315984,43.4898072115066],[-1.4711496640194455,43.488988948298214],[-1.4704729059495025,43.490552305753525],[-1.4691668013624646,43.49021953595435],[-1.468096262415347,43.49165687643397],[-1.466962059613767,43.49139563900458],[-1.464478364862934,43.48951766203621],[-1.465271845089921,43.4880030091329],[-1.4660801436525606,43.48818692538975],[-1.4668614225016992,43.487379092794015],[-1.464741197154749,43.48526300082266],[-1.466295906483788,43.48397790149624],[-1.4654868371544227,43.481336346426154],[-1.4643017604392001,43.480430799957055],[-1.4632814344071423,43.482162791090715],[-1.4599722574254628,43.48214637981415],[-1.4604299999999992,43.479696],[-1.466390999999998,43.47625099999998],[-1.4678269999999987,43.47622599999999],[-1.4661849999999976,43.47504199999998],[-1.467592999999999,43.47264899999998],[-1.4667399999999984,43.47196199999996],[-1.4694309999999988,43.47130800000001],[-1.4701602049231632,43.46948096399001],[-1.4701994960997757,43.47730987364495],[-1.4715772096898776,43.481036070710296],[-1.4714547992699583,43.482286104707065],[-1.473034566165901,43.48416511265194],[-1.4732389474646113,43.48630219128211],[-1.4740593629244574,43.486529910372845],[-1.4745274139065903,43.48798587384075]]]]}},{"type":"Feature","properties":{"bv":17},"geometry":{"type":"Polygon","coordinates":[[[-1.4952446166808961,43.493359021049535],[-1.4942942044869427,43.496639453871595],[-1.4899912159522766,43.49862791715547],[-1.4881394137443165,43.50225340584549],[-1.4857865346661265,43.50047627320196],[-1.4880922338700433,43.49743652794581],[-1.4853316587194352,43.49668697137853],[-1.4850172178073555,43.49609887788022],[-1.4858204590236728,43.494214794926286],[-1.4867058788729557,43.494281861092084],[-1.4866670673499043,43.494952702512215],[-1.4878249529724494,43.495667767111364],[-1.4889208770178253,43.49544316101444],[-1.4893164520232303,43.49613837321919],[-1.4900192103877492,43.494519811153644],[-1.4904356101082985,43.494934627075814],[-1.4942521538024933,43.49287002278409],[-1.4952446166808961,43.493359021049535]]]}},{"type":"Feature","properties":{"bv":18},"geometry":{"type":"Polygon","coordinates":[[[-1.483833862525005,43.494579061513654],[-1.4855014125010393,43.495115738792286],[-1.4853316587194352,43.49668697137853],[-1.4880922338700433,43.49743652794581],[-1.4857865346661265,43.50047627320196],[-1.4836967567040942,43.500300598485246],[-1.4794194483559657,43.498021806053394],[-1.4778307852277959,43.49797044635936],[-1.4778977944761382,43.49510691089609],[-1.479733988882118,43.49285038173898],[-1.4815050982981874,43.49391365767194],[-1.4820322285080474,43.49323379008679],[-1.4822804040614994,43.49401217641652],[-1.483833862525005,43.494579061513654]]]}},{"type":"Feature","properties":{"bv":19},"geometry":{"type":"Polygon","coordinates":[[[-1.488032999581467,43.48745145382254],[-1.4889714798836262,43.48876003279301],[-1.4877722638412703,43.48892157643309],[-1.4876140080569926,43.49011208346104],[-1.4862916492816232,43.48926258275232],[-1.4872467948625294,43.49096940329263],[-1.4855014125010393,43.495115738792286],[-1.4830785058619418,43.49459273775269],[-1.4820322285080474,43.49323379008679],[-1.4815050982981874,43.49391365767194],[-1.479733988882118,43.49285038173898],[-1.4807909607558989,43.489489395682284],[-1.4807328117686978,43.487270087077654],[-1.4860327869248273,43.48727173088835],[-1.4871953712691504,43.48676565953234],[-1.488032999581467,43.48745145382254]]]}},{"type":"Feature","properties":{"bv":2},"geometry":{"type":"Polygon","coordinates":[[[-1.480923789454678,43.488570595097094],[-1.4797297757393524,43.49185818661697],[-1.4778607638202037,43.492267366295],[-1.4757496956684084,43.49099190225914],[-1.4741359284914246,43.492372000379845],[-1.4752002504078094,43.48937240375205],[-1.4768394105951455,43.489834073258606],[-1.4775201590748976,43.48905580570555],[-1.4776287300558402,43.4895637191552],[-1.4787773041210028,43.48966132876315],[-1.4803878840136617,43.48707023252565],[-1.480923789454678,43.488570595097094]]]}},{"type":"Feature","properties":{"bv":20},"geometry":{"type":"MultiPolygon","coordinates":[[[[-1.4911514946222073,43.48789950294723],[-1.4924197945957833,43.49136708642998],[-1.4942521538024933,43.49287002278409],[-1.4904356101082985,43.494934627075814],[-1.4900192103877492,43.494519811153644],[-1.4895533301329842,43.49604511412085],[-1.4889208770178253,43.49544316101444],[-1.4878249529724494,43.495667767111364],[-1.4860213538358535,43.49417057110188],[-1.4872467948625294,43.49096940329263],[-1.4862916492816232,43.48926258275232],[-1.4876140080569926,43.49011208346104],[-1.4878378838766744,43.48886064354308],[-1.4889068753729333,43.48892269772173],[-1.487664254795185,43.486811625072384],[-1.490192433703645,43.4849375136206],[-1.4911514946222073,43.48789950294723]]],[[[-1.4935669999999985,43.49910699999999],[-1.4904089999999985,43.50301499999999],[-1.4912008780257302,43.50412910498832],[-1.4881394137443165,43.50225340584549],[-1.4899912159522766,43.49862791715547],[-1.4907474648336172,43.49871226326784],[-1.4920104923586142,43.49733784373198],[-1.4942942044869427,43.496639453871595],[-1.4935669999999985,43.49910699999999]]]]}},{"type":"Feature","properties":{"bv":21},"geometry":{"type":"Polygon","coordinates":[[[-1.4912008780257302,43.50412910498832],[-1.4924889999999988,43.50657999999999],[-1.4927639999999993,43.508587999999996],[-1.492050999999998,43.511949],[-1.4867759999999994,43.512073],[-1.4858039999999992,43.51370399999999],[-1.4847439999999983,43.514235999999975],[-1.4829939999999988,43.51326899999997],[-1.4771791073335985,43.51367428886811],[-1.4763398145330664,43.511598261474745],[-1.4770520420116102,43.5066123391845],[-1.4751155387584827,43.50523352777744],[-1.4745074824315332,43.50565998350106],[-1.4735036229303626,43.50316580954855],[-1.4741710256183034,43.50171496435084],[-1.4739628355859662,43.50015483889627],[-1.476113336676239,43.49863841764782],[-1.4794194483559657,43.498021806053394],[-1.4836967567040942,43.500300598485246],[-1.4857865346661265,43.50047627320196],[-1.4887192404948715,43.50302480189432],[-1.4912008780257302,43.50412910498832]]]}},{"type":"Feature","properties":{"bv":22},"geometry":{"type":"Polygon","coordinates":[[[-1.4704696608693617,43.498746140039685],[-1.4739628355859662,43.50015483889627],[-1.4741710256183034,43.50171496435084],[-1.4735036229303626,43.50316580954855],[-1.470333503363468,43.504184616237275],[-1.4693489353892484,43.50332857325192],[-1.4679249354545425,43.50352583363634],[-1.4672244215563317,43.500246526004126],[-1.4659176165699759,43.50087472494519],[-1.4652890533411433,43.49977266341059],[-1.4646196981981958,43.500235301801794],[-1.463811700548718,43.49955356394528],[-1.4619561941736008,43.5004475629892],[-1.4604103813178526,43.498669631218014],[-1.4621734861861075,43.49689681618787],[-1.462087085836031,43.49617974406794],[-1.4627265977901802,43.497015425333174],[-1.4632791497172863,43.49634139128484],[-1.4634604067081147,43.49707191188423],[-1.4704696608693617,43.498746140039685]]]}},{"type":"Feature","properties":{"bv":23},"geometry":{"type":"Polygon","coordinates":[[[-1.4748499999999982,43.50587452747251],[-1.4751155387584827,43.50523352777744],[-1.4770520420116102,43.5066123391845],[-1.4763398145330664,43.511598261474745],[-1.4771791073335985,43.51367428886811],[-1.4721439999999988,43.514923999999986],[-1.471182999999999,43.515899],[-1.4693459999999983,43.515887],[-1.4684869999999994,43.51688899999998],[-1.4656799999999999,43.51630699999999],[-1.460885692196043,43.51846853096063],[-1.4588330365130227,43.512872573440994],[-1.459670268138569,43.51231814253575],[-1.4609054435505293,43.51405317154254],[-1.4632377627505473,43.515358616157336],[-1.4622846087873893,43.51381652153408],[-1.4638971371620324,43.51319744208084],[-1.4625295812425638,43.51226363783443],[-1.464000860568901,43.5107729196043],[-1.4616790066843022,43.50954811962102],[-1.4635431687570437,43.50917418191169],[-1.463500336073383,43.50832299371752],[-1.4650748388137302,43.50701529392795],[-1.4647340598763183,43.50971709614697],[-1.4654834726034334,43.50871546221222],[-1.4673953738639616,43.509552853722774],[-1.4679772175246264,43.50812726169504],[-1.4672253197226581,43.50681662288133],[-1.4679280066943023,43.50596260995941],[-1.4669896376811595,43.50514383152174],[-1.466946780976649,43.50408796155097],[-1.4693489353892484,43.50332857325192],[-1.4697228803110198,43.50404594510525],[-1.4716779259152908,43.50400719968185],[-1.4735036229303626,43.50316580954855],[-1.4748499999999982,43.50587452747251]]]}},{"type":"Feature","properties":{"bv":24},"geometry":{"type":"MultiPolygon","coordinates":[[[[-1.4672291748226498,43.50102022963739],[-1.467948287691033,43.50340023647254],[-1.466946780976649,43.50408796155097],[-1.4669672928626212,43.505016162182876],[-1.4655476956887237,43.50490253491253],[-1.4661494212420232,43.50407489065581],[-1.4653159297351286,43.50353299476205],[-1.4644210451557558,43.505119156795],[-1.4635451212905999,43.50472717771946],[-1.4631560529371774,43.505953667818666],[-1.4620320743848738,43.50529911362455],[-1.4606413093310613,43.50561211588428],[-1.4586482574183997,43.50381605644555],[-1.4565918036882008,43.50382709838474],[-1.4572908868781957,43.50143005594098],[-1.4585098477387708,43.501831866568736],[-1.4589480095783163,43.50294838052703],[-1.4603402902606752,43.5020539714573],[-1.4607418917239623,43.50120284260306],[-1.4592267050029728,43.50016108355371],[-1.4604103813178526,43.498669631218014],[-1.4619561941736008,43.5004475629892],[-1.463811700548718,43.49955356394528],[-1.4646196981981958,43.500235301801794],[-1.4652890533411433,43.49977266341059],[-1.4659176165699759,43.50087472494519],[-1.4672244215563317,43.500246526004126],[-1.4672291748226498,43.50102022963739]]],[[[-1.4554310612627377,43.503892960244684],[-1.4540315129498305,43.50500844772469],[-1.45596525797984,43.50856315639691],[-1.4514237499761828,43.51309253057248],[-1.450755344925998,43.51593901372045],[-1.4494950445856924,43.51614092904089],[-1.446130476059397,43.511513601217025],[-1.445175315968984,43.5077613594952],[-1.4474027137119123,43.506417756367874],[-1.4500759545702884,43.50715277101746],[-1.4504888372743243,43.5034356549329],[-1.4516695105007624,43.50361539187238],[-1.4539872215661076,43.502447437202996],[-1.4554310612627377,43.503892960244684]]]]}},{"type":"Feature","properties":{"bv":25},"geometry":{"type":"MultiPolygon","coordinates":[[[[-1.4674467825172717,43.50567459522378],[-1.4679280066943023,43.50596260995941],[-1.4672683582941568,43.507191334116854],[-1.4679772175246264,43.50812726169504],[-1.4673953738639616,43.509552853722774],[-1.4654834726034334,43.50871546221222],[-1.4647340598763183,43.50971709614697],[-1.4650748388137302,43.50701529392795],[-1.463500336073383,43.50832299371752],[-1.4635431687570437,43.50917418191169],[-1.4616790066843022,43.50954811962102],[-1.464000860568901,43.5107729196043],[-1.4625295812425638,43.51226363783443],[-1.4638971371620324,43.51319744208084],[-1.4622846087873893,43.51381652153408],[-1.4632377627505473,43.515358616157336],[-1.4609054435505293,43.51405317154254],[-1.459670268138569,43.51231814253575],[-1.4588330365130227,43.512872573440994],[-1.460885692196043,43.51846853096063],[-1.4592909999999986,43.518867],[-1.4565129999999984,43.518120999999994],[-1.4542929999999987,43.51605099999999],[-1.450755344925998,43.51593901372045],[-1.4514237499761828,43.51309253057248],[-1.45596525797984,43.50856315639691],[-1.4540315129498305,43.50500844772469],[-1.4554310612627377,43.503892960244684],[-1.4586482574183997,43.50381605644555],[-1.4606413093310613,43.50561211588428],[-1.4620320743848738,43.50529911362455],[-1.4631560529371774,43.505953667818666],[-1.4635451212905999,43.50472717771946],[-1.4644210451557558,43.505119156795],[-1.4653159297351286,43.50353299476205],[-1.4661494212420232,43.50407489065581],[-1.4655476956887237,43.50490253491253],[-1.4669672928626212,43.505016162182876],[-1.4674467825172717,43.50567459522378]]],[[[-1.445140199600146,43.50774562986343],[-1.446130476059397,43.511513601217025],[-1.4494950445856924,43.51614092904089],[-1.4447949999999996,43.515234],[-1.4427239999999983,43.514027999999996],[-1.4412429999999987,43.51426099999996],[-1.4406640000000002,43.51333199999998],[-1.4378493255943305,43.51312194976597],[-1.4376466189084687,43.51235677768149],[-1.4387372693214315,43.51219135608605],[-1.438574818520643,43.510768742405624],[-1.4397503743035063,43.511888309246025],[-1.4406427455892692,43.51133348767935],[-1.441947812576269,43.51229818644121],[-1.4419905994498705,43.51121722362066],[-1.4440931085746784,43.51037908052735],[-1.4417631894452074,43.50747995628187],[-1.4432169451339016,43.50714447419987],[-1.445140199600146,43.50774562986343]]]]}},{"type":"Feature","properties":{"bv":26},"geometry":{"type":"Polygon","coordinates":[[[-1.4608332697152386,43.49446610715414],[-1.4598674168058947,43.496943928833915],[-1.460700817412271,43.49804885324483],[-1.4590570046164126,43.49970005341604],[-1.456263943103213,43.497954901145825],[-1.4551697801444246,43.49882382196811],[-1.4537709868439073,43.498218779909664],[-1.4534224896095944,43.497427903909625],[-1.4514735951022115,43.49819395005171],[-1.4509921702977493,43.497536005446605],[-1.4508203077452406,43.49513074338358],[-1.4524981276301494,43.49388043719257],[-1.4558867477121735,43.495056596402144],[-1.4578110821385415,43.49298371796703],[-1.4588332854011463,43.49378227514246],[-1.4592070843713123,43.49328425989913],[-1.460701152564423,43.493445069386524],[-1.4608332697152386,43.49446610715414]]]}},{"type":"Feature","properties":{"bv":27},"geometry":{"type":"Polygon","coordinates":[[[-1.4571299786246061,43.498325241115964],[-1.4590570046164126,43.49970005341604],[-1.4594432675773268,43.49878365917048],[-1.4600331823139472,43.498847421338745],[-1.4601577063450464,43.49958179382972],[-1.4592287317321682,43.50027464576704],[-1.4607418917239623,43.50120284260306],[-1.4589480095783163,43.50294838052703],[-1.4585098477387708,43.501831866568736],[-1.4572908868781957,43.50143005594098],[-1.4565918036882008,43.50382709838474],[-1.4554310612627377,43.503892960244684],[-1.4537312975759353,43.500693466154345],[-1.4503245675563055,43.50211438451203],[-1.4483701265320585,43.50112178879797],[-1.4469940707154991,43.50307405345386],[-1.4461406901404958,43.50329202368466],[-1.445814853952953,43.50054262629023],[-1.4470046377006955,43.499562221462604],[-1.4475554999999982,43.49802690528633],[-1.4483522834206324,43.498407620473685],[-1.4503955542307196,43.49696439415689],[-1.4514735951022115,43.49819395005171],[-1.4534224896095944,43.497427903909625],[-1.4537709868439073,43.498218779909664],[-1.4551697801444246,43.49882382196811],[-1.455695927587546,43.49804979350451],[-1.4571299786246061,43.498325241115964]]]}},{"type":"Feature","properties":{"bv":28},"geometry":{"type":"Polygon","coordinates":[[[-1.4535072228483443,43.5024387524663],[-1.4516695105007624,43.50361539187238],[-1.4502032248722625,43.503612313599895],[-1.4500759545702884,43.50715277101746],[-1.4474027137119123,43.506417756367874],[-1.445339856617356,43.504504610707606],[-1.4483701265320585,43.50112178879797],[-1.4503245675563055,43.50211438451203],[-1.4537312975759353,43.500693466154345],[-1.4543081103155808,43.50255055157782],[-1.4535072228483443,43.5024387524663]]]}},{"type":"Feature","properties":{"bv":29},"geometry":{"type":"MultiPolygon","coordinates":[[[[-1.4366692580983413,43.49433833145296],[-1.4361740873946238,43.49509055277837],[-1.4354850058561068,43.49480158310092],[-1.4366692580983413,43.49433833145296]]],[[[-1.4464617675200313,43.49979056762347],[-1.445814853952953,43.50054262629023],[-1.4461406901404958,43.50329202368466],[-1.445339856617356,43.504504610707606],[-1.4474027137119123,43.506417756367874],[-1.445175315968984,43.5077613594952],[-1.4432169451339016,43.50714447419987],[-1.4417631894452074,43.50747995628187],[-1.4440931085746784,43.51037908052735],[-1.4419905994498705,43.51121722362066],[-1.441947812576269,43.51229818644121],[-1.4406427455892692,43.51133348767935],[-1.4397503743035063,43.511888309246025],[-1.438574818520643,43.510768742405624],[-1.4387372693214315,43.51219135608605],[-1.4376466189084687,43.51235677768149],[-1.4378493255943305,43.51312194976597],[-1.431155999999999,43.514496999999984],[-1.4261909999999993,43.509542999999994],[-1.4235739999999988,43.50442199999998],[-1.4223459999999992,43.504651999999986],[-1.4209589999999999,43.50284399999997],[-1.418382,43.50233199999998],[-1.4187859999999983,43.500527000000005],[-1.4173119999999986,43.49983999999999],[-1.417773999999999,43.497013999999986],[-1.423257366082127,43.496135317587346],[-1.423829262155982,43.49918185906434],[-1.4279408552101813,43.500178558844546],[-1.4295922990007286,43.495187307835266],[-1.4329098359347887,43.497561141082784],[-1.435427078435675,43.49595600196866],[-1.4375102347474413,43.49636767494729],[-1.4381460641951826,43.4954840885656],[-1.439848424468239,43.494983101504836],[-1.4403185366914466,43.4958628829511],[-1.440391425248105,43.49482711866394],[-1.4417811810800127,43.49582442180077],[-1.4414147134795485,43.49726392762701],[-1.4422591172556167,43.49803197340578],[-1.4438247665309114,43.495695475563],[-1.4448879983205891,43.49765704093171],[-1.4467041117551231,43.49685687585336],[-1.446598939727717,43.498683363395244],[-1.4470928798217966,43.49876499954103],[-1.4464617675200313,43.49979056762347]]]]}},{"type":"Feature","properties":{"bv":3},"geometry":{"type":"MultiPolygon","coordinates":[[[[-1.479748241859066,43.48680615039938],[-1.4803878840136617,43.48707023252565],[-1.4787773041210028,43.48966132876315],[-1.4776287300558402,43.4895637191552],[-1.4775201590748976,43.48905580570555],[-1.4768394105951455,43.489834073258606],[-1.4752002504078094,43.48937240375205],[-1.474736281590807,43.49011478663747],[-1.4740593629244574,43.486529910372845],[-1.4732389474646113,43.48630219128211],[-1.473034566165901,43.48416511265194],[-1.4714547992699583,43.482286104707065],[-1.4715772096898776,43.481036070710296],[-1.4701994960997757,43.47730987364495],[-1.4701822584737938,43.46683554034897],[-1.4745861536695848,43.47577268272814],[-1.4733390600650567,43.47998950896286],[-1.4751990104220218,43.47985600220176],[-1.4759124657754292,43.48069029417589],[-1.4756161090638225,43.48295264327383],[-1.4763970621040263,43.484281585451676],[-1.4748610858486044,43.48650701623008],[-1.4764450888658764,43.48705216061723],[-1.479748241859066,43.48680615039938]]],[[[-1.477068963999999,43.481485107999994],[-1.4783809146917082,43.481798833816455],[-1.4771247988180845,43.48238286321242],[-1.4760545592670924,43.48208009312128],[-1.477068963999999,43.481485107999994]]]]}},{"type":"Feature","properties":{"bv":30},"geometry":{"type":"Polygon","coordinates":[[[-1.4594522163887107,43.48802784947514],[-1.4602986126144881,43.48827749512898],[-1.4601865711171496,43.49130851537122],[-1.4581715573955019,43.49169567057623],[-1.4578110821385415,43.49298371796703],[-1.4558867477121735,43.495056596402144],[-1.4524981276301494,43.49388043719257],[-1.4516772055184932,43.49428694945392],[-1.4508203077452406,43.49513074338358],[-1.4508617855427954,43.49705724249782],[-1.4490103106370054,43.49746814609018],[-1.4483522834206324,43.498407620473685],[-1.4475554999999982,43.49802690528633],[-1.446598939727717,43.498683363395244],[-1.4467041117551231,43.49685687585336],[-1.4448879983205891,43.49765704093171],[-1.4438247665309114,43.495695475563],[-1.4422591172556167,43.49803197340578],[-1.4414147134795485,43.49726392762701],[-1.4417811810800127,43.49582442180077],[-1.440391425248105,43.49482711866394],[-1.4403185366914466,43.4958628829511],[-1.439848424468239,43.494983101504836],[-1.4381460641951826,43.4954840885656],[-1.4375102347474413,43.49636767494729],[-1.435427078435675,43.49595600196866],[-1.4329098359347887,43.497561141082784],[-1.4295922990007286,43.495187307835266],[-1.4279408552101813,43.500178558844546],[-1.423829262155982,43.49918185906434],[-1.423257366082127,43.496135317587346],[-1.428472999999999,43.494233],[-1.4342949999999977,43.48994399999997],[-1.4451329999999987,43.48624299999997],[-1.4438849999999994,43.48418499999999],[-1.4455115676131383,43.48336741418536],[-1.4482964391162236,43.48641314612731],[-1.4542064078929473,43.484466211466795],[-1.4580893866414986,43.48645301966195],[-1.4594522163887107,43.48802784947514]],[[-1.4354926858286263,43.494741008593415],[-1.4361740873946238,43.49509055277837],[-1.4366692580983413,43.49433833145296],[-1.4354926858286263,43.494741008593415]]]}},{"type":"Feature","properties":{"bv":4},"geometry":{"type":"Polygon","coordinates":[[[-1.4729724196009373,43.4899121866197],[-1.474736281590807,43.49011478663747],[-1.4734541044769012,43.49445672714191],[-1.471130884614849,43.49398097296695],[-1.468096262415347,43.49165687643397],[-1.4691668013624646,43.49021953595435],[-1.4704729059495025,43.490552305753525],[-1.4711496640194455,43.488988948298214],[-1.4729724196009373,43.4899121866197]]]}},{"type":"Feature","properties":{"bv":5},"geometry":{"type":"MultiPolygon","coordinates":[[[[-1.4723703274137783,43.49440911687844],[-1.4751130940712567,43.49526126591005],[-1.476113336676239,43.49863841764782],[-1.4739628355859662,43.50015483889627],[-1.4685863375370276,43.498027809451045],[-1.4637879683879578,43.497144512050994],[-1.4671893449229587,43.49532592680756],[-1.4673213673050733,43.49450126624916],[-1.4685774183071478,43.493939303739644],[-1.4693013298514044,43.49270223037551],[-1.4723703274137783,43.49440911687844]]]]}},{"type":"Feature","properties":{"bv":6},"geometry":{"type":"Polygon","coordinates":[[[-1.468096262415347,43.49165687643397],[-1.4693013298514044,43.49270223037551],[-1.4685774183071478,43.493939303739644],[-1.4673213673050733,43.49450126624916],[-1.4671893449229587,43.49532592680756],[-1.465203073075843,43.49593745397602],[-1.4639098961543133,43.49512800776442],[-1.4642082263505851,43.49397914860192],[-1.463412376355743,43.49345387093276],[-1.4650377432884516,43.492411624309156],[-1.464091420382166,43.49174940127388],[-1.4652805128062658,43.49011720097221],[-1.466962059613767,43.49139563900458],[-1.4663975871670727,43.492941584745765],[-1.4673802957145383,43.491550753616224],[-1.468096262415347,43.49165687643397]]]}},{"type":"Feature","properties":{"bv":7},"geometry":{"type":"Polygon","coordinates":[[[-1.4632276768935675,43.48878204633797],[-1.4652805128062658,43.49011720097221],[-1.464091420382166,43.49174940127388],[-1.4650377432884516,43.492411624309156],[-1.463412376355743,43.49345387093276],[-1.4642082263505851,43.49397914860192],[-1.4639098961543133,43.49512800776442],[-1.4651678913145678,43.496252990397416],[-1.4637827845987372,43.497147789632],[-1.4632791497172863,43.49634139128484],[-1.4627265977901802,43.497015425333174],[-1.462087085836031,43.49617974406794],[-1.4621734861861075,43.49689681618787],[-1.4607067905489053,43.498008088526625],[-1.4598674168058947,43.496943928833915],[-1.460751712310932,43.49347811626584],[-1.4592070843713123,43.49328425989913],[-1.4588332854011463,43.49378227514246],[-1.4578110821385415,43.49298371796703],[-1.4581715573955019,43.49169567057623],[-1.4601865711171496,43.49130851537122],[-1.4602986126144881,43.48827749512898],[-1.4632276768935675,43.48878204633797]]]}},{"type":"Feature","properties":{"bv":8},"geometry":{"type":"MultiPolygon","coordinates":[[[[-1.4919335095576496,43.47933236922594],[-1.4898222468869307,43.48355622153087],[-1.490192433703645,43.4849375136206],[-1.487509551672255,43.48688503150609],[-1.4835505113368732,43.4874413885474],[-1.4748610858486044,43.48650701623008],[-1.4763970621040263,43.484281585451676],[-1.4756161090638225,43.48295264327383],[-1.4758976995831306,43.48209253253849],[-1.4771247988180845,43.48238286321242],[-1.4793112272246827,43.48172885136589],[-1.4810717337117478,43.482116090783904],[-1.4843700942509657,43.48461150440159],[-1.4852781087345137,43.484298796577995],[-1.4855442057096258,43.48347266362152],[-1.4858866463310696,43.484277426435305],[-1.4865494528044394,43.48428342326369],[-1.4877957433527833,43.483122386577875],[-1.4875869348625321,43.48037206860179],[-1.4899358068287984,43.47925995720549],[-1.4915629080325286,43.477559972243114],[-1.4919335095576496,43.47933236922594]]]]}},{"type":"Feature","properties":{"bv":9},"geometry":{"type":"Polygon","coordinates":[[[-1.4899358068287984,43.47925995720549],[-1.4874141744951404,43.480534375947144],[-1.4877957433527833,43.483122386577875],[-1.4865494528044394,43.48428342326369],[-1.4858866463310696,43.484277426435305],[-1.4855442057096258,43.48347266362152],[-1.4852781087345137,43.484298796577995],[-1.4843700942509657,43.48461150440159],[-1.4810717337117478,43.482116090783904],[-1.4832257547719396,43.479230825602436],[-1.4830217351824482,43.47845497203706],[-1.4852927316154323,43.47777522714663],[-1.4862988461779294,43.47952571272225],[-1.4872519167986824,43.478511325307714],[-1.4879304839726717,43.479616763005765],[-1.48829700497201,43.47850305669755],[-1.4892167979110644,43.47853266269392],[-1.4889884581993562,43.47799761443924],[-1.4914933204750416,43.47677040003571],[-1.4915629080325286,43.477559972243114],[-1.4899358068287984,43.47925995720549]]]}}]};
</script>
<script>
const SHEET_ID='1nxp3CwXHkbcdmAz5PBgHGhZ2rtfXRwhl0ci1971VwX8';
const SHEET_NAME='1erTour';
const REFRESH_S=60, SLIDE_MS=12000, TOTAL_BV=30, N_SLIDES=8;
const SEUIL_2ND=0.10, SEUIL_PROP=0.05;
const BV_NAMES={"1": "Mairie", "2": "Cathédrale", "3": "Lauga", "4": "Petit Bayonne", "5": "Gare", "6": "Als. Lorraine", "7": "St-Esprit Jaurès", "8": "St Léon", "9": "Lahubiague", "10": "Marracq Panorama", "11": "Marracq Biraben", "12": "Polo Beyris Sud", "13": "Polo Beyris Nord", "14": "Saint Amand", "15": "Prissé", "16": "Mousserolles", "17": "Balichon Ouest", "18": "Balichon Est", "19": "Arènes Tribunal", "20": "Arènes Ouest", "21": "St Bernard", "22": "Citadelle", "23": "Coumères", "24": "Caradoc", "25": "Habas", "26": "Ste Croix / Stade DD", "27": "Pl. des Gascons", "28": "Ste Croix Breuer Est", "29": "Séqué", "30": "Arrousets"};

const LISTES=[
  {key:'pereira',    nom:'Pereira (LFI)', long:'Liste Pereira',        hex:'#1a3a6e'},
  {key:'iriart',     nom:'Iriart (BM)',   long:'Bayonne en Mouvement', hex:'#2d7a3a'},
  {key:'etcheto',    nom:'Etcheto',       long:'Liste Etcheto',        hex:'#c0436e'},
  {key:'etchegaray', nom:'Etchegaray',    long:'Liste Etchegaray',     hex:'#b03030'},
  {key:'lesellier',  nom:'Lesellier (RN)',long:'Liste Lesellier – RN', hex:'#5a2d14'},
];
const CANDS=[
  {sid:'s3',key:'pereira',    hex:'#1a3a6e'},
  {sid:'s4',key:'iriart',     hex:'#2d7a3a'},
  {sid:'s5',key:'etcheto',    hex:'#c0436e'},
  {sid:'s6',key:'etchegaray', hex:'#b03030'},
  {sid:'s7',key:'lesellier',  hex:'#5a2d14'},
];
const BLOCS=[
  {id:'gauche',name:'Gauche',color:'#2d7a3a',sub:'BM + Etcheto + LFI',
   segs:[{key:'iriart',hex:'#2d7a3a',label:'BM'},{key:'etcheto',hex:'#c0436e',label:'Etcheto'},{key:'pereira',hex:'#1a3a6e',label:'LFI'}]},
  {id:'centre',name:'Centre et Droite',color:'#b03030',sub:'Etchegaray',
   segs:[{key:'etchegaray',hex:'#b03030',label:''}]},
  {id:'rn',name:'RN',color:'#5a2d14',sub:'Lesellier',
   segs:[{key:'lesellier',hex:'#5a2d14',label:''}]},
];
const SLIDE_LABELS=['Résultats globaux','Participation','Pereira','Iriart (BM)','Etcheto','Etchegaray','Lesellier','Synthèse'];
const ALL_SLIDE_IDS=['s1','s2','s3','s4','s5','s6','s7','s8'];

var data=[],curSlide=1,paused=false,sTimer=null,cdTimer=null,cdVal=REFRESH_S;

// ── FETCH ──
async function fetchData(){
  // Spinner sur tous les boutons refresh
  ALL_SLIDE_IDS.forEach(function(sid){
    var b=document.getElementById('rbtn'+sid);if(b)b.classList.add('spin');});
  var url='https://docs.google.com/spreadsheets/d/'+SHEET_ID+'/gviz/tq?tqx=out:json&sheet='+encodeURIComponent(SHEET_NAME);
  try{
    var text=await(await fetch(url)).text();
    var json=JSON.parse(text.match(/google\.visualization\.Query\.setResponse\(([\s\S]*)\)/)[1]);
    data=[];
    (json.table.rows||[]).forEach(function(row){
      var c=row.c; if(!c)return;
      var bv=nv(c[0]); if(!bv||bv>TOTAL_BV)return;
      data.push({bv:bv,inscrits:nv(c[1]),abstentions:nv(c[2]),votants:nv(c[3]),
        blancs:nv(c[4]),nuls:nv(c[5]),exprimes:nv(c[6]),
        iriart:nv(c[7]),etchegaray:nv(c[8]),etcheto:nv(c[9]),
        pereira:nv(c[10]),lesellier:nv(c[11]),valide:sv(c[12])==='OUI'});
    });
    refresh();
    cdVal=REFRESH_S;
  }catch(e){console.warn('fetch err:',e);}
  ALL_SLIDE_IDS.forEach(function(sid){
    var b=document.getElementById('rbtn'+sid);if(b)b.classList.remove('spin');});
}
function nv(c){if(!c||c.v===null||c.v===undefined)return null;if(typeof c.v==='number')return c.v;var n=parseFloat(String(c.v).replace(',','.'));return isNaN(n)?null:n;}
function sv(c){return(!c||c.v===null)?'':String(c.v).trim().toUpperCase();}

// ── CALCULS — uniquement sur BV validés (colonne M = OUI) ──
function globals(){
  var vd=data.filter(function(r){return r.valide;});
  var s=function(k){return vd.reduce(function(a,r){return a+(r[k]||0);},0);};
  return{nbDep:vd.length,
    inscrits:s('inscrits'),votants:s('votants'),abstentions:s('abstentions'),
    blancs:s('blancs'),nuls:s('nuls'),exprimes:s('exprimes'),
    pereira:s('pereira'),iriart:s('iriart'),etcheto:s('etcheto'),
    etchegaray:s('etchegaray'),lesellier:s('lesellier')};
}
function pct(n,d){return(!d||d===0)?null:n/d*100;}
function fp(v,dec){dec=dec===undefined?1:dec;return v===null?'–':v.toFixed(dec)+' %';}
function fn(v){return v===null?'–':Math.round(v).toLocaleString('fr-FR');}
function setBadge(sid,nbDep){
  var pDep=Math.round(nbDep/TOTAL_BV*100);
  document.getElementById(sid+'bv').textContent=nbDep+' / '+TOTAL_BV;
  var ps=document.getElementById(sid+'bvps');
  if(ps)ps.textContent=nbDep>0?pDep+' % obtenus':'';
}

// ── SLIDE 1 ──
function drawSlide1(g){
  setBadge('s1',g.nbDep);
  document.getElementById('vpart').textContent=fp(pct(g.votants,g.inscrits));
  document.getElementById('vabst').textContent=fp(pct(g.abstentions,g.inscrits));
  document.getElementById('vblanc').textContent=fp(pct(g.blancs,g.votants));
  document.getElementById('vnul').textContent=fp(pct(g.nuls,g.votants));
  document.getElementById('sp-sub').textContent=g.inscrits?fn(g.votants)+' / '+fn(g.inscrits)+' inscrits':'';
  document.getElementById('sa-sub').textContent=g.abstentions?fn(g.abstentions)+' abst.':'';
  document.getElementById('sb-sub').textContent=g.blancs!==null?fn(g.blancs)+' bulletins':'';
  document.getElementById('sn-sub').textContent=g.nuls!==null?fn(g.nuls)+' bulletins':'';
  var c=document.getElementById('chart'); c.innerHTML='';
  var mx=Math.max.apply(null,LISTES.map(function(l){return pct(g[l.key],g.exprimes)||0;}).concat([5]));
  LISTES.forEach(function(l){
    var voix=g[l.key]||0, p=pct(voix,g.exprimes);
    var bw=(p!==null&&mx>0)?Math.max(p/mx*86,p>0?0.5:0):0, wide=bw>14;
    var div=document.createElement('div'); div.className='brow';
    var inner='<div class="blbl"><span class="ln">'+l.long+'</span>';
    inner+='<span class="cn">'+l.nom+(voix>0?' · '+fn(voix)+' voix':'')+'</span></div>';
    inner+='<div class="btrk"><div class="bline"></div>';
    inner+='<div class="bfill" style="background:'+l.hex+';width:'+bw+'%">';
    if(wide&&p!==null)inner+='<span class="bpct">'+fp(p)+'</span>';
    inner+='</div>';
    if(!wide&&p!==null)inner+='<span class="bpct-o">'+fp(p)+'</span>';
    if(p===null)inner+='<span class="bpct-o" style="color:#ccc">–</span>';
    inner+='</div>';
    div.innerHTML=inner; c.appendChild(div);
  });
}

// ── CARTES ──
function lerpC(a,b,t){
  var r1=parseInt(a.slice(1,3),16),g1=parseInt(a.slice(3,5),16),b1=parseInt(a.slice(5,7),16);
  var r2=parseInt(b.slice(1,3),16),g2=parseInt(b.slice(3,5),16),b2=parseInt(b.slice(5,7),16);
  return 'rgb('+Math.round(r1+(r2-r1)*t)+','+Math.round(g1+(g2-g1)*t)+','+Math.round(b1+(b2-b1)*t)+')';
}
var _proj=null;
function setupProj(svgEl){
  var lons=[],lats=[];
  function col(ring){ring.forEach(function(c){lons.push(c[0]);lats.push(c[1]);});}
  GEOJSON.features.forEach(function(f){var g=f.geometry;
    if(g.type==='Polygon')g.coordinates.forEach(col);
    else g.coordinates.forEach(function(p){p.forEach(col);});});
  var x0=Math.min.apply(null,lons),x1=Math.max.apply(null,lons);
  var y0=Math.min.apply(null,lats),y1=Math.max.apply(null,lats);
  var cosLat=Math.cos((y0+y1)/2*Math.PI/180);
  var PAD=14,SVG_W=500,SVG_H=Math.round((SVG_W-PAD*2)*(y1-y0)/((x1-x0)*cosLat))+PAD*2;
  svgEl.setAttribute('viewBox','0 0 '+SVG_W+' '+SVG_H);
  _proj={x0:x0,x1:x1,y0:y0,y1:y1,VW:SVG_W-PAD*2,VH:SVG_H-PAD*2,PAD:PAD};
}
function prj(lon,lat){return[_proj.PAD+(lon-_proj.x0)/(_proj.x1-_proj.x0)*_proj.VW,_proj.PAD+(_proj.y1-lat)/(_proj.y1-_proj.y0)*_proj.VH];}
function ringD(ring){return ring.map(function(c,i){var p=prj(c[0],c[1]);return(i?'L':'M')+p[0].toFixed(1)+' '+p[1].toFixed(1);}).join('')+'Z';}
function geomD(g){if(g.type==='Polygon')return g.coordinates.map(ringD).join(' ');return g.coordinates.map(function(p){return p.map(ringD).join(' ');}).join(' ');}
function centroid(g){
  var xs=[],ys=[];
  function col(ring){ring.forEach(function(c){xs.push(c[0]);ys.push(c[1]);});}
  if(g.type==='Polygon')g.coordinates.forEach(col);
  else g.coordinates.forEach(function(p){p.forEach(col);});
  return[xs.reduce(function(a,b){return a+b;},0)/xs.length,ys.reduce(function(a,b){return a+b;},0)/ys.length];
}

function drawMap(sid,colorFn,labelFn,tooltipFn,maxValFn,colorA,colorB){
  var svg=document.getElementById('msv'+sid);
  var pg=document.getElementById('mp'+sid),lg=document.getElementById('ml'+sid);
  pg.innerHTML='';lg.innerHTML='';
  setupProj(svg);
  var maxVal=maxValFn(),dispMax=maxVal>0?Math.ceil(maxVal/5)*5:100;
  var lgmax=document.getElementById('lgmax'+sid);if(lgmax)lgmax.textContent=dispMax+' %';
  var lgg=document.getElementById('lg'+sid);if(lgg)lgg.style.background='linear-gradient(to right,'+colorA+','+colorB+')';
  var tt=document.getElementById('mtt'+sid),cont=document.getElementById('mw'+sid);
  GEOJSON.features.forEach(function(feat){
    var bvn=feat.properties.bv;
    var r=data.find(function(d){return d.bv==bvn;}),dep=r&&r.valide;
    var val=dep?colorFn(r):null,fill='#c8c8c8',tCol='#888';
    if(val!==null){
      var t=maxVal>0?Math.min(val/maxVal,1):0;
      fill=lerpC(colorA,colorB,t);
      var lum=0.299*parseInt(colorB.slice(1,3),16)+0.587*parseInt(colorB.slice(3,5),16)+0.114*parseInt(colorB.slice(5,7),16);
      tCol=(t>0.55&&lum<140)?'#fff':(t>0.55?'#333':'#555');
    }
    var path=document.createElementNS('http://www.w3.org/2000/svg','path');
    path.setAttribute('d',geomD(feat.geometry));
    path.setAttribute('fill',fill);
    path.setAttribute('stroke','rgba(255,255,255,0.8)');
    path.setAttribute('stroke-width','1');
    path.style.cursor='pointer';
    path.addEventListener('mouseenter',function(){tt.innerHTML=tooltipFn(bvn,r,dep);tt.style.display='block';});
    path.addEventListener('mousemove',function(e){var rc=cont.getBoundingClientRect();tt.style.left=(e.clientX-rc.left+14)+'px';tt.style.top=(e.clientY-rc.top+14)+'px';});
    path.addEventListener('mouseleave',function(){tt.style.display='none';});
    pg.appendChild(path);
    // Afficher SEULEMENT le %, pas le numéro BV — numéro visible uniquement en survol (dans tooltip)
    var ct=centroid(feat.geometry),cp=prj(ct[0],ct[1]);
    var fs=Math.max(6,Math.min(13,_proj.VW/30));
    var lbl=dep?labelFn(r):null;
    if(lbl){
      var tp=document.createElementNS('http://www.w3.org/2000/svg','text');
      tp.setAttribute('x',cp[0]);tp.setAttribute('y',cp[1]+fs*.38);
      tp.setAttribute('text-anchor','middle');tp.setAttribute('font-size',fs.toFixed(1));
      tp.setAttribute('font-weight','bold');tp.setAttribute('fill',tCol);
      tp.setAttribute('font-family','Source Sans 3,sans-serif');
      tp.textContent=lbl;lg.appendChild(tp);
    }
  });
}

function drawSlide2(g){
  setBadge('s2',g.nbDep);
  document.getElementById('s2part').textContent=fp(pct(g.votants,g.inscrits));
  document.getElementById('s2part-sub').textContent=g.inscrits?fn(g.votants)+' votants':'';
  document.getElementById('s2abst').textContent=fp(pct(g.abstentions,g.inscrits));
  document.getElementById('s2abst-sub').textContent=g.abstentions?fn(g.abstentions)+' abst.':'';
  document.getElementById('s2ins').textContent=fn(g.inscrits);
  document.getElementById('s2ins-sub').textContent='inscrits';
  var mp=Math.max.apply(null,data.filter(function(r){return r.valide&&r.inscrits;}).map(function(r){return pct(r.votants,r.inscrits)||0;}).concat([1]));
  drawMap('s2',
    function(r){return pct(r.votants,r.inscrits);},
    function(r){return Math.round(pct(r.votants,r.inscrits))+'%';},
    function(bvn,r,dep){
      var nm=BV_NAMES[bvn]?BV_NAMES[bvn]+' (BV '+bvn+')':'BV '+bvn;
      if(!dep)return '<b>'+nm+'</b><br>Résultats non obtenus';
      return '<b>'+nm+'</b><br>Part. : '+fp(pct(r.votants,r.inscrits))+'<br>'+fn(r.votants)+' / '+fn(r.inscrits)+' inscrits';},
    function(){return mp;},'#fffde7','#f57f17');
}

function hexLight(hex){
  var rv=parseInt(hex.slice(1,3),16),gv=parseInt(hex.slice(3,5),16),bv=parseInt(hex.slice(5,7),16);
  var lr=Math.round(rv*.15+255*.85),lg2=Math.round(gv*.15+255*.85),lb=Math.round(bv*.15+255*.85);
  return '#'+lr.toString(16).padStart(2,'0')+lg2.toString(16).padStart(2,'0')+lb.toString(16).padStart(2,'0');
}
function drawCandSlide(g,cand){
  var sid=cand.sid,key=cand.key,hex=cand.hex;
  setBadge(sid,g.nbDep);
  var tv=g[key]||0,gp=pct(tv,g.exprimes);
  document.getElementById(sid+'pct').textContent=fp(gp);
  document.getElementById(sid+'pct-sub').textContent=tv>0?'sur '+fn(g.exprimes)+' exprimés':'';
  document.getElementById(sid+'vx').textContent=fn(tv);
  document.getElementById(sid+'vx-sub').textContent=tv>0?'voix totales':'';
  var deps=data.filter(function(r){return r.valide&&r.exprimes&&r[key]!==null;});
  var b1='–',b1s='';
  if(deps.length>0){
    var best=deps.reduce(function(a,b){return pct(b[key],b.exprimes)>pct(a[key],a.exprimes)?b:a;});
    var bnm=BV_NAMES[best.bv]||('BV '+best.bv);
    b1=bnm+' · '+Math.round(pct(best[key],best.exprimes))+'%';
    b1s=fn(best[key])+' voix';
  }
  document.getElementById(sid+'bv1').textContent=b1;
  document.getElementById(sid+'bv1-sub').textContent=b1s;
  var mp=Math.max.apply(null,deps.map(function(r){return pct(r[key],r.exprimes)||0;}).concat([1]));
  drawMap(sid,
    function(r){return pct(r[key],r.exprimes);},
    function(r){return Math.round(pct(r[key],r.exprimes))+'%';},
    function(bvn,r,dep){
      var nm=BV_NAMES[bvn]?BV_NAMES[bvn]+' (BV '+bvn+')':'BV '+bvn;
      if(!dep)return '<b>'+nm+'</b><br>Résultats non obtenus';
      return '<b>'+nm+'</b><br>Score : '+fp(pct(r[key],r.exprimes))+' ('+fn(r[key])+' voix)<br>Exprimés : '+fn(r.exprimes);},
    function(){return mp;},hexLight(hex),hex);
}

// ── SLIDE 8 ──
function drawSlide8(g){
  setBadge('s8',g.nbDep);
  var seuilIns=g.inscrits*SEUIL_2ND;
  var seuilExp=g.exprimes*SEUIL_PROP;
  var complet=g.nbDep===TOTAL_BV;

  // Classement — toutes les listes ≥ 10% inscrits sont qualifiées (pas de plafond)
  var ranked=LISTES.slice().sort(function(a,b){return (g[b.key]||0)-(g[a.key]||0);});
  var rows=document.getElementById('cls-rows'); rows.innerHTML='';
  ranked.forEach(function(l,i){
    var voix=g[l.key]||0, p=pct(voix,g.exprimes);
    var hasMaj=g.exprimes>0&&voix>g.exprimes/2;
    var q2nd=g.inscrits>0&&voix>=seuilIns;   // ≥ 10% inscrits
    var qPR=g.exprimes>0&&voix>=seuilExp;    // > 5% exprimés
    var badge='',bc='';
    if(g.inscrits>0&&g.exprimes>0){
      if(hasMaj){bc='ok';badge='★ Majorité absolue';}
      else if(complet){bc=q2nd?'ok':'no';badge=q2nd?'✓ 2nd tour':'✗ Éliminé(e)';}
      else{bc='prov';badge=q2nd?'~ 2nd tour (prov.)':'~ Éliminé (prov.)';}
      if(!hasMaj&&qPR) badge+=' · RP';
    }
    var div=document.createElement('div'); div.className='cls-row';
    var inner='<span class="cls-rank">'+(i+1)+'</span>';
    inner+='<span class="cls-dot" style="background:'+l.hex+'"></span>';
    inner+='<div class="cls-info"><span class="cls-nom">'+l.long+'</span>';
    inner+='<span class="cls-detail">'+l.nom+(badge?'&nbsp;·&nbsp;<span class="cls-badge '+bc+'">'+badge+'</span>':'')+'</span></div>';
    inner+='<div class="cls-right"><span class="cls-pct" style="color:'+l.hex+'">'+fp(p)+'</span>';
    inner+='<span class="cls-voix">'+fn(voix)+' voix</span></div>';
    div.innerHTML=inner; rows.appendChild(div);
  });

  // ── Histogramme blocs ──
  var hist=document.getElementById('bloc-hist'); hist.innerHTML='';
  var blocsVals=BLOCS.map(function(b){
    var total=b.segs.reduce(function(s,seg){return s+(g[seg.key]||0);},0);
    return {b:b,total:total,pt:pct(total,g.exprimes)};
  });
  var maxPct=Math.max.apply(null,blocsVals.map(function(d){return d.pt||0;}).concat([5]));

  // Hauteur du conteneur en px — on lit après layout
  // On utilise % relatif : colonne max = 100% de la zone barres
  // La zone barres = (hauteur conteneur - espace légende)
  // On calcule en %, les barres sont en position absolute dans un conteneur relatif
  blocsVals.forEach(function(bd){
    var b=bd.b,total=bd.total,pt=bd.pt;
    var colH=pt!==null&&maxPct>0?Math.round(pt/maxPct*100):0;

    var colEl=document.createElement('div'); colEl.className='bhcol';

    var barWrap=document.createElement('div'); barWrap.className='bhcol-bars';
    // Hauteur en % de la zone disponible (flex parent)
    barWrap.style.height=colH+'%';

    // % total flottant au-dessus
    var ptopEl=document.createElement('div'); ptopEl.className='bh-pct-top';
    ptopEl.style.color=b.color;
    ptopEl.textContent=pt!==null?fp(pt,0):'–';
    barWrap.appendChild(ptopEl);

    // Segments empilés : on construit du BAS vers le HAUT
    // Avec flexDirection=column, le premier enfant est en HAUT
    // Donc on inverse l'ordre pour avoir BM en bas
    var segsRev=b.segs.slice().reverse();
    segsRev.forEach(function(seg){
      var v=g[seg.key]||0;
      var segH=total>0?(v/total*100):0;
      var segEl=document.createElement('div'); segEl.className='bh-seg';
      segEl.style.background=seg.hex;
      segEl.style.height=segH+'%';
      if(segH>10&&seg.label){
        var lblEl=document.createElement('div'); lblEl.className='bh-seg-lbl';
        lblEl.textContent=seg.label; segEl.appendChild(lblEl);
      }
      barWrap.appendChild(segEl);
    });
    // Le dernier segment ajouté = le haut → border-radius en haut sur le dernier
    // (segsRev[0] = LFI = haut, segsRev[last] = BM = bas)
    if(barWrap.children.length>1){
      barWrap.children[1].style.borderRadius='6px 6px 0 0';
    }

    colEl.appendChild(barWrap);
    var legEl=document.createElement('div'); legEl.className='bh-legend';
    legEl.innerHTML='<span class="bh-leg-name" style="color:'+b.color+'">'+b.name+'</span>'
      +'<span class="bh-leg-sub">'+b.sub+'</span>'
      +'<span class="bh-leg-voix">'+(total>0?fn(total)+' voix':'–')+'</span>';
    colEl.appendChild(legEl);
    hist.appendChild(colEl);
  });
}

function refresh(){
  var g=globals();
  drawSlide1(g);drawSlide2(g);
  CANDS.forEach(function(c){drawCandSlide(g,c);});
  drawSlide8(g);
}
function goSlide(n){
  document.getElementById('s'+curSlide).classList.remove('active');
  document.getElementById('d'+curSlide).classList.remove('active');
  curSlide=n;
  document.getElementById('s'+curSlide).classList.add('active');
  document.getElementById('d'+curSlide).classList.add('active');
  document.getElementById('slide-lbl').textContent=SLIDE_LABELS[n-1];
}
function nextSlide(){goSlide(curSlide===N_SLIDES?1:curSlide+1);}
function prevSlide(){goSlide(curSlide===1?N_SLIDES:curSlide-1);}
function startTimer(){if(sTimer)clearInterval(sTimer);sTimer=setInterval(nextSlide,SLIDE_MS);}
function stopTimer(){if(sTimer){clearInterval(sTimer);sTimer=null;}}
document.getElementById('bnext').addEventListener('click',function(){nextSlide();if(!paused){stopTimer();startTimer();}});
document.getElementById('bprev').addEventListener('click',function(){prevSlide();if(!paused){stopTimer();startTimer();}});
document.getElementById('bpause').addEventListener('click',function(){
  paused=!paused;var b=document.getElementById('bpause');
  if(paused){stopTimer();b.innerHTML='&#9654;';b.classList.add('paused');b.title='Reprendre';}
  else{startTimer();b.innerHTML='&#9646;&#9646;';b.classList.remove('paused');b.title='Pause';}
});
document.addEventListener('keydown',function(e){
  if(e.code==='Space'){e.preventDefault();document.getElementById('bpause').click();}
  if(e.code==='ArrowRight')document.getElementById('bnext').click();
  if(e.code==='ArrowLeft')document.getElementById('bprev').click();
  var n=parseInt(e.key);if(n>=1&&n<=N_SLIDES)goSlide(n);
});
// Boutons refresh sur chaque slide
ALL_SLIDE_IDS.forEach(function(sid){
  var b=document.getElementById('rbtn'+sid);
  if(b)b.addEventListener('click',function(){fetchData();cdVal=REFRESH_S;});
});
function resetCd(){
  cdVal=REFRESH_S;document.getElementById('cdown').textContent=cdVal;
  if(cdTimer)clearInterval(cdTimer);
  cdTimer=setInterval(function(){cdVal--;document.getElementById('cdown').textContent=cdVal;if(cdVal<=0){fetchData();}},1000);
}
refresh();fetchData();startTimer();resetCd();
</script>
</body>
</html>
